\newpage

\begin{CJK*}{GBK}{song}

\setcounter{chapter}{5}
\setcounter{section}{0}

\chapter{广告其他相关技术}

\thispagestyle{empty}
\markboth{广告其他相关技术}{广告其他相关技术}
在前面几章中，我们以在线广告市场上产品形态发展的过程为主线，对按合约售卖的广告系统、非实时竞价的广告网络、和实时竞价的广告交易市场作了介绍，并对其中与各种产品形态密切相关的计算技术进行了深入讨论。除了这些骨干性的技术以外，在线广告中还有一些非常重要的外围问题，我们在这一章里，将对这些问题展开讨论，目的是为了让大家对实际广告系统的各个环节都有全面而实际的认识。

我们在前面的章节中讨论的所有技术和算法，其核心都是为了优化广告效果。不过前面谈到的广告效果优化思路，基本上集中在受众定向的角度，而在实际的在线广告中，还有一项对广告效果影响巨大的技术，那就是创意优化。创意优化与受众优化性质有所不同，因为创意的改变实际上也改变了广告要表达的诉求。如何在基本的宣传诉求相对稳定的前提下，结合受众定向对创意做调整，这是广告系统不能不考虑的重要问题。对于这方面的方法和思路，我们放在这一章里单独讨论。

与广告效果的度量相关，有两个问题需要介绍，一是如何在流量中去除那些恶意的和非主动的流量，这部分我们称为流量保护。其中去除恶意流量的反作弊问题，由于是一个“道高一尺、魔高一丈”的动态博弈过程，因此并无确定不变的技术和算法，不过也有一些原则和基础方法可以遵循，我们将重点介绍这方面的内容。二是需求方站在自己的利益角度对广告效果的核实性度量，这称为广告监测。这两个问题其实有着相当深入的联系，在今天程序交易和受众定向大量被使用的在线广告市场中，这两个问题在一定程度上可以结合起来考虑，并催生了所谓“广告安全(Ad Safety)”的问题和相应技术。

受众定向和程序交易广告的另一个重要影响，是用户的行为数据存在在不同的广告产品之家按泄露的可能。因此，隐私保护技术与其对立面，即去匿名化技术，从正面或者负面的角度，都与在线广告有着密切的联系。关于隐私保护相关问题，以及其在广告中的可能应用，也是本章涉及到的内容。

本书虽然力求根据在线广告的核心逻辑来展开技术和算法方面的讨论，在实际行文中则是以桌面操作系统的显示广告为主要参照对象。而我们都知道，随着社交(Social)、 本地(Local)、 移动(Mobile)等因素在互联网业务中快速的发展，所谓“SoLoMo”的趋势也越来越显著。在这些新趋势下的广告系统，虽然业务逻辑的本质没有根本变化，但也带来了一些崭新的产品形态和技术挑战。

\section{创意优化}

\begin{figure}\label{fig_creative}
\centering
\scalebox{0.6}
{
    \includegraphics[width=1.65\textwidth]{creative.eps}
}
\caption{品牌性创意和效果性创意}
\end{figure}

创意对于广告效果的影响无疑是巨大的，然而我们不能把调整创意带来的效果等同于受众定向产生的效果。因为随着创意的改变，实际上广告主通过广告表达的诉求已经发生了变化，其点击行为也就不再与其他创意具有完全的可比性。我们可以通过一个例子来理解这个问题：假如有一个汽车广告主，将一个宣传某款新车概念的品牌性广告创意，变成一个用户填写试驾申请的表单式创意，如图\ref{fig_creative}所示。毫无疑问的是，后者的点击率会大幅度上升。但是实际上，这两个创意向用户传达的该汽车品牌的形象，却有着相当大的区别：前者的目的是向潜在用户渗透性地宣传品牌的定位，以利于将来长期的用户转化和利润空间；而后者的目的则是短期内的转化效果，但对品牌特质的宣传则有所不足。

因此，我们重点讨论在广告的基本诉求保持相对稳定的前提下，如果对创意做微调以显著提高效果。这样的创意优化，依据的基本原理，是我们在第一章的广告有效性模型中就介绍过的原则：为了提高用户的关注程度，我们需要将向用户推送此广告的主要原因在创意中明确表达出来。

\section{流量保护和效果监测}

流量保护(Traffic Protection)这个概念，包括两方面的内容：一是对非主动用户访问行为，主要是爬虫行为的去除；二是反作弊，其对于恶意展示或流量来源的去除。从技术难度上来看，我们主要关注的是后一个问题。反作弊的检测方案，在在线环境和离线环境中都有需求，并且是广告计价和其他数据统计的基础步骤。另一个在线完成的辅助任务，是为广告主服务的广告监测服务，它为了完成广告的展示和点击计数，当然也需要一定的反作弊处理，因此这两个问题有很多密切的联系，我们在此一并讨论。

\subsection{爬虫流量去除}

在广告系统中，并不是所有的广告展示和点击都来自于实际的用户。特别是随着搜索引擎技术的发展，网络爬虫带来的流量往往占相当大的比例。爬虫再打开页面时会触发广告展示，也会在探索新的链接时触发广告点击。爬虫流量的去除比较简单，应为比较规范的搜索引擎会在抓取页面时做声明，而其他一些不做声明的爬虫，也比较容易线下收集其IP，于是用一个黑名单来去除这部分流量即可。

对爬虫流量的过滤，最好在广告服务前端的http服务中直接配置实现，即对于已知的爬虫带来的页面请求，服务器直接返回空，而不做任何广告检索和排序的逻辑，这样对服务器压力的减轻有一定帮助。

\subsection{反作弊}

由于广告有若干相关利益方，因此除了那些无恶意的、机器产生的流量，经常也会遇到大量的恶意的展示或点击行为，即作弊行为。作弊的具体手段五花八门，无法一一列举，并且随着反作弊手段的进步而不断进步。要在面对广告作弊时快速找到思路，需要先搞清作弊者的目的。我们知道，广告活动是广告主、媒体与用户之间三方交互的行为，因此广告中的作弊行为主要有两种情况：

一、媒体作弊。媒体是广告活动的主要受益者，因而作弊的动力也最强。展示的作弊相对来说比较困难，因为必然涉及到非正常地触发一些虚假的用户访问。由于大多数广告网络与媒体之间是按照点击的价格来结算，因此点击作弊是最为常见的，当然也存在为了满足CPM订单量的需求而对展示进行作弊的情形。这种作弊的花样繁多，既有将广告展示和点击代码放在非约定位置上或非用户自然行为产生的流量上的方式，也有通过将广告位与内容靠得很近甚至相互重叠来骗取点击的方式。

二、广告主竞争对手作弊。某些广告主的竞争对手，会通过技术手段大量消耗该广告主的预算，达到降低其广告效果的非正常竞争目的。与媒体作弊不同，广告主的竞争对手很难通过控制广告位置或复制代码的方式来作弊，而是通过多次重复点击广告的形式来作弊。由于通过单一IP或cookie来大量点击广告很容易被发现，作弊方往往会通过频繁清楚cookie，改变IP，甚至通过木马控制多台用户电脑来达到作弊的目的，当然，这样的作弊手段也被媒体作弊，或者帮助媒体作弊的技术提供商所采用。

针对不同的作弊方式，也有不同的反作弊思路。单一IP或cookie在大量展示或点击的作弊方式是最容易去除的，只需要一定时间段内的展示或点击设定合理的上限，并进而发现那些显著超过上限的IP或cookie加入黑名单即可。对于更复杂的，通过控制多台电脑来产生假点击的作弊方式，点击热点图是一项很有用的反作弊技术：正常的用户点击，在创意上的位置分布往往呈现与创意关键区域相关的比较自然的分布；而及其产生的用户点击，其分布要么过于均匀，要么过于集中，很容易与自然点击分布相区别。下图给出了一个广告创意正常的点击热点分布于作弊的点击热点分布的示例。通过观察关键位置，关键广告主的点击热点图，往往可以发现作弊行为的一些重要线索。当然，这种方法虽然行之有效，却需要一定程度的人工干预，因此并不适用于在所有流量上普遍采用。

\begin{figure}\label{fig_creative}
\centering
\scalebox{0.6}
{
    \includegraphics[width=1.65\textwidth]{creative.eps}
}
\caption{自然点击热点分布与机器作弊点击热点分布对比}
\end{figure}

\subsection{效果监测}

在线广告区别于线下广告的重要特征，就是其可监测性。不论是CPM还是CPC计费方式，从需求方来看，都存在切实的需求，委托某家第三方监测公司对实际发生的展示或点击数目进行核对，以确保自己的利益。

\subsection{广告安全}

为了服务于广告主，将流量监测、作弊监测和品牌保护等一系列任务都一站式地完成，从而保证广告投放过程对于广告主的安全性，市场上产生了广告安全相关的技术公司。

\section{隐私保护和数据安全}

熟悉互联网上推荐技术发展的朋友们应该都不会对Netflix百万美元推荐大赛感到陌生。然而，这一推荐大赛只进行了一届就嘎然而止，其背后的原因就不是所有人都关注到的。实际上，这是由于在一项相关的用户隐私研究中，Arvind Narayanan等人发现通过一些数据挖掘的技术手段，可以将这些公开的行为数据与Internet Movie Database
(IMDb)的数据对应起来，发现他们背后共同的用户。这样的结果让业界感到不安，因为简单地将用户身份等关键信息从数据中去除已经不能满足意思保护的要求。因此，这一比赛也就不再进行了。

上面的例子提醒我们，在充分利用用户信息提高广告效果的同时，绝对不能忽视对用户隐私的尊重和保护。广告中会遇到哪些与用户隐私有关的问题的？我们在这里对其中一些关键点也做一些最基础的讨论，目的是希望大家在应用定向广告技术时对这方面的风险有充分的重视，并可以预先采取一些防控措施。

当然，与隐私保护相对应的技术，就是所谓\begin{CJK*}{GBK}{kai}去匿名化(De-anonymization)\end{CJK*}，也即通过数据上的一些特征将已经去掉身份标识的两条用户行为记录或其他信息对应起来。这方面的技术如果能够合理利用，对于广告产品主动拓展数据来源，提高定向的精准性会有非常大的帮助，关于这方面的现有技术和广告主可能的正面利用，我们也做简要讨论。

\subsection{用户身份标识}

要讨论用户隐私相关问题，我们先来看看在线广告中是如何对用户身份进行跟踪的。在不同的广告形式中，采用的用户身份标识也不尽相同。

对于在Web的环境下投送的在线广告，用户身份的标识可以采用http协议提供的cookie机制来完成。cookie机制在安全性方面有很多好处，比如每个域名下的服务只能访问本域名下的cookie，这实际上是由浏览器保证了不同Web应用之间用户数据的隔离。不过cookie在用户跟踪的有效性方面受到一些限制：首先，用户可以主动清除cookie，于是广告系统对该用户的跟踪就中断了；另外，由于广告网络往往是在其他域名的网站上跟踪用户和投放广告，其种植的cookie是第三方cookie。而对于第三方cookie，浏览器一般有更为严格的限制，有的浏览器甚至会在默认情况下禁止第三方cookie，这也成为行为定向的障碍。随着市场对用户隐私问题越来越关注，W3C还进一步制定了“Do Not Track (DNT)”的标准，用于用户主动向网站要求不要被跟踪，或者不要被网站上的第三方应用所跟踪。cookie的跟踪方式还有一个问题，那就是当某台电脑的用户使用多个浏览器时，其cookie无法直接被统一起来。

在有用户登录信息的广告产品中，用户登陆的身份往往是比浏览器cookie更强的身份标识，而最典型的情形出现在社交广告中。用户登录信息不仅在接续性上远远好于普通的浏览器cookie，还具有能够打通不同的桌面和移动设备的功能。因此，创造网站功能以鼓励用户登陆，是很多从事广告的互联网公司都在努力的方向。当然，也不能认为用户登陆身份的准确性一定好于浏览器cookie。例如，在某些游戏性质较强的产品中，由于一个用户可能创建多个“马甲”参与，会导致其用户标识相当不准确。

在移动互联设备中，特别是应用内，无法使用cookie来跟踪用户。于是，移动广告产品往往利用设备的国际移动设备身份码(International Mobile Equipment Identity, IMEI)号码来唯一地表示设备或用户。不过，如果没有用户等于信息，我们很难将此设备号与某个跟踪到的桌面用户对应起来。对于一些需要用户登陆的移动服务，例如即时通讯工具，则有天然的优势将桌面用户与移动设备关联起来，创造跨屏营销的广告体验。

\subsection{去匿名化技术及应用}

实际上，仅仅将用户的唯一标识从数据中去掉，是不能达到用户隐私保护的目的的。研究表明，由于用户的行为信息空间是非常稀疏的，因此如果我们了解某个用户的一小部分信息，就有可能在一个匿名化的用户行为数据集上将其找出来，并从而得知该用户的更多信息。这也就是去匿名化技术。

去匿名化技术在广告系统中有可能有着正面的应用：如果我们通过计算，在若干身份标识不一致或者缺失的行为数据集上进行去匿名化，那么有可能将这几部分数据对应起来，从而扩展了用户行为的丰富程度，提高了定向的精准性。如果这一过程能被严格控制在机器执行，而不允许人直接访问数据，那么这一过程就是有隐私保证并且有实际价值的。

我们来看看去匿名化技术的现状，以及广告系统的数据拓展问题对此技术提出的需求。

\subsection{RTB中的数据安全问题}

RTB的产生，使得在线广告市场可以综合利用需求方和供给方的数据来完成更加精准的广告决策。当然，这样的便利性也是一把双刃剑，在数据得到更加充分利用的同时，RTB中供给方和需求方对于数据安全性的顾虑和诉求也不能不加以考虑。

我们先来看看供给方的数据安全性问题。由于在RTB过程中，Adx需要向参与竞价的DSP广播每次展示的URL和cookie，使得DSP理论上存在规模化监听媒体用户行为的可能。如下图所示，假设有某个恶意的DSP，对于能够参与竞价的所有广告请求，都以很低的价格参与竞价，目的不在于赢得流量，而在于收集媒体上的用户行为，这就产生了媒体数据的安全问题，我们将其称为供给方数据安全(Supply Data Security)，我们在第七章中介绍RTB原理时也曾经提到过这一问题。

供给方的数据安全问题尽管在RTB中确实存在，但是并不是想象中那样严重。我们可以回顾一下第七章里介绍过的询价优化技术：由于带宽的限制，实际上在每次询价时，Adx应该尽可能只向那些最可能赢得竞价的DSP发送询价请求，而那些以恶意收集数据为目的的DSP，在理想情况下应该被挡在大部分的询价以外。

再来看看需求方的数据安全性问题。为了表达更加清楚，我们用下图的例子来说明一下。假设有两个化妆品电商广告主A和B，两者都通过DSP进行个性化重定向广告采买，那么他们分别利用RTB的方式接触到了自己的顾客集合。需要注意的是，这里的顾客集合实际上是广告主的私有数据，也是特别具有商业价值的数据，然而，DSP、Adx 和媒体都可能在RTB过程中得到这些顾客集合。如果Adx希望制造更加激烈的竞价环境，获得更高的利润，那么它实际上可以将这两个广告主的顾客集合合并在一起，并生产一个相应的用户标签吸引双方来对此标签竞价。这种做法的实质，是在竞争对手之间倒卖顾客集合，并且可以通过比较模糊的标签名字(比如为上面两个化妆品广告主的顾客集合打上“年轻女性”的标签)非常隐蔽地操作。随着竞价激烈程度的增加，原本属于广告主的利润就向市场其他环节发生了转移，我们把这个问题称为需求方数据安全性问题。

需求方数据安全性某种意义上比供给方数据安全性更加重要，因为这决定了广告主是否可以放心地通过RTB进行广告采买。***************************

\section{SoLoMo时代的广告}

\subsection{移动广告}

移动广告，指的是在各种移动终端上向用户投送的在线广告。

\subsection{社交广告}


\clearpage{\pagestyle{empty}} %\cleardoublepage

\end{CJK*}
